{"version":3,"file":"_server.ts-BcaUK5PB.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/dashboard/_server.ts.js"],"sourcesContent":["import { json } from \"@sveltejs/kit\";\nconst GET = async ({ url }) => {\n  try {\n    const { getAccountStats } = await import(\"../../../../chunks/db-loader.js\");\n    const stats = await getAccountStats();\n    const generateTrendData = (current) => {\n      const variance = 0.05 + Math.random() * 0.1;\n      const direction = Math.random() > 0.6 ? 1 : -1;\n      return Math.max(0, Math.round(current * (1 + direction * variance)));\n    };\n    const availableCount = stats.byStatus[\"Unused\"] || 0;\n    const issueCount = (stats.byStatus[\"Login Error\"] || 0) + (stats.byStatus[\"Password Error\"] || 0) + (stats.byStatus[\"Critical Error\"] || 0);\n    const inProgressCount = stats.byStatus[\"Login In Progress\"] || 0;\n    const trendData = {\n      total: {\n        current: stats.total,\n        previous: generateTrendData(stats.total)\n      },\n      available: {\n        current: availableCount,\n        previous: generateTrendData(availableCount)\n      },\n      issues: {\n        current: issueCount,\n        previous: generateTrendData(issueCount)\n      },\n      inProgress: {\n        current: inProgressCount,\n        previous: generateTrendData(inProgressCount)\n      }\n    };\n    const responseData = {\n      stats,\n      trendData,\n      metadata: {\n        timestamp: (/* @__PURE__ */ new Date()).toISOString(),\n        version: \"1.0.0\",\n        cached: false\n        // Could be used for caching optimization later\n      }\n    };\n    const headers = new Headers({\n      \"Cache-Control\": \"no-cache, no-store, must-revalidate\",\n      \"Pragma\": \"no-cache\",\n      \"Expires\": \"0\"\n    });\n    return json({\n      success: true,\n      data: responseData\n    }, {\n      status: 200,\n      headers\n    });\n  } catch (error) {\n    console.error(\"Failed to load dashboard data:\", error);\n    return json({\n      success: false,\n      error: \"Failed to retrieve dashboard data\",\n      details: error instanceof Error ? error.message : \"Unknown error\"\n    }, {\n      status: 500,\n      headers: {\n        \"Cache-Control\": \"no-cache\"\n      }\n    });\n  }\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":"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"}