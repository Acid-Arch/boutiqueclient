import"../chunks/DsnmJJEf.js";import{i as ie}from"../chunks/DX-Oc8op.js";import{ai as j,g as e,s as A,aS as $t,p as D,c as M,f as $,a as c,b as R,an as et,d as L,e as n,ao as Yt,r,aU as ne,o as le,l as xt,j as ce,m as G,q as dt,i as _,u as I,n as z,t as F,k as tt,v as U,aM as de}from"../chunks/3zx2OM-S.js";import{p as S,i as at,r as J,s as K,l as kt,a as ue,c as ve}from"../chunks/Dwjkgfq3.js";import{e as fe,i as ge}from"../chunks/z8oQ6GeD.js";import{I as Pt,s as st}from"../chunks/BID1lDIu.js";import{c as ut}from"../chunks/ugyboSLg.js";import{b as Tt,c as E,B as bt,d as yt,f as he,s as wt,a as St}from"../chunks/lPcixCUF.js";import{a as Vt,p as me}from"../chunks/CZ88HukD.js";import"../chunks/9ZzghxzE.js";import{a as It,c as pe,w as _e,d as At,b as O,m as Ct}from"../chunks/BQu96azb.js";import{C as xe,D as be,S as ye}from"../chunks/CN0Dtqqk.js";import{U as we}from"../chunks/BAf6IcXK.js";import{D as Se,C as $e}from"../chunks/dcpnCTTX.js";import{T as ke}from"../chunks/DkmbWJ8q.js";const Mt=pe({component:"avatar",parts:["root","image","fallback"]}),Ot=new xe("Avatar.Root");class jt{static create(t){return Ot.set(new jt(t))}opts;domContext;attachment;constructor(t){this.opts=t,this.domContext=new be(this.opts.ref),this.loadImage=this.loadImage.bind(this),this.attachment=It(this.opts.ref)}loadImage(t,o,d){if(this.opts.loadingStatus.current==="loaded")return;let s;const a=new Image;return a.src=t,o!==void 0&&(a.crossOrigin=o),d&&(a.referrerPolicy=d),this.opts.loadingStatus.current="loading",a.onload=()=>{s=this.domContext.setTimeout(()=>{this.opts.loadingStatus.current="loaded"},this.opts.delayMs.current)},a.onerror=()=>{this.opts.loadingStatus.current="error"},()=>{s&&this.domContext.clearTimeout(s)}}#t=j(()=>({id:this.opts.id.current,[Mt.root]:"","data-status":this.opts.loadingStatus.current,...this.attachment}));get props(){return e(this.#t)}set props(t){A(this.#t,t)}}class Lt{static create(t){return new Lt(t,Ot.get())}opts;root;attachment;constructor(t,o){this.opts=t,this.root=o,this.attachment=It(this.opts.ref),_e.pre([()=>this.opts.src.current,()=>this.opts.crossOrigin.current],([d,s])=>{if(!d){this.root.opts.loadingStatus.current="error";return}this.root.loadImage(d,s,this.opts.referrerPolicy.current)})}#t=j(()=>({id:this.opts.id.current,style:{display:this.root.opts.loadingStatus.current==="loaded"?"block":"none"},"data-status":this.root.opts.loadingStatus.current,[Mt.image]:"",src:this.opts.src.current,crossorigin:this.opts.crossOrigin.current,referrerpolicy:this.opts.referrerPolicy.current,...this.attachment}));get props(){return e(this.#t)}set props(t){A(this.#t,t)}}class zt{static create(t){return new zt(t,Ot.get())}opts;root;attachment;constructor(t,o){this.opts=t,this.root=o,this.attachment=It(this.opts.ref)}#t=j(()=>this.root.opts.loadingStatus.current==="loaded"?{display:"none"}:void 0);get style(){return e(this.#t)}set style(t){A(this.#t,t)}#e=j(()=>({style:this.style,"data-status":this.root.opts.loadingStatus.current,[Mt.fallback]:"",...this.attachment}));get props(){return e(this.#e)}set props(t){A(this.#e,t)}}var Pe=L("<div><!></div>");function Te(h,t){const o=$t();D(t,!0);let d=S(t,"delayMs",3,0),s=S(t,"loadingStatus",15,"loading"),a=S(t,"id",19,()=>At(o)),i=S(t,"ref",15,null),v=J(t,["$$slots","$$events","$$legacy","delayMs","loadingStatus","onLoadingStatusChange","child","children","id","ref"]);const y=jt.create({delayMs:O.with(()=>d()),loadingStatus:O.with(()=>s(),l=>{s()!==l&&(s(l),t.onLoadingStatusChange?.(l))}),id:O.with(()=>a()),ref:O.with(()=>i(),l=>i(l))}),g=j(()=>Ct(v,y.props));var k=M(),C=$(k);{var m=l=>{var x=M(),N=$(x);et(N,()=>t.child,()=>({props:e(g)})),c(l,x)},p=l=>{var x=Pe();Tt(x,()=>({...e(g)}));var N=n(x);et(N,()=>t.children??Yt),r(x),c(l,x)};at(C,l=>{t.child?l(m):l(p,!1)})}c(h,k),R()}var Ie=L("<img/>");function Ae(h,t){const o=$t();D(t,!0);let d=S(t,"id",19,()=>At(o)),s=S(t,"ref",15,null),a=S(t,"crossorigin",3,void 0),i=S(t,"referrerpolicy",3,void 0),v=J(t,["$$slots","$$events","$$legacy","src","child","id","ref","crossorigin","referrerpolicy"]);const y=Lt.create({src:O.with(()=>t.src),id:O.with(()=>d()),ref:O.with(()=>s(),l=>s(l)),crossOrigin:O.with(()=>a()),referrerPolicy:O.with(()=>i())}),g=j(()=>Ct(v,y.props));var k=M(),C=$(k);{var m=l=>{var x=M(),N=$(x);et(N,()=>t.child,()=>({props:e(g)})),c(l,x)},p=l=>{var x=Ie();Tt(x,()=>({...e(g),src:t.src})),ne(x),c(l,x)};at(C,l=>{t.child?l(m):l(p,!1)})}c(h,k),R()}var Ce=L("<span><!></span>");function Me(h,t){const o=$t();D(t,!0);let d=S(t,"id",19,()=>At(o)),s=S(t,"ref",15,null),a=J(t,["$$slots","$$events","$$legacy","children","child","id","ref"]);const i=zt.create({id:O.with(()=>d()),ref:O.with(()=>s(),m=>s(m))}),v=j(()=>Ct(a,i.props));var y=M(),g=$(y);{var k=m=>{var p=M(),l=$(p);et(l,()=>t.child,()=>({props:e(v)})),c(m,p)},C=m=>{var p=Ce();Tt(p,()=>({...e(v)}));var l=n(p);et(l,()=>t.children??Yt),r(p),c(m,p)};at(g,m=>{t.child?m(k):m(C,!1)})}c(h,y),R()}function Oe(h,t){D(t,!0);let o=S(t,"ref",15,null),d=S(t,"loadingStatus",15,"loading"),s=J(t,["$$slots","$$events","$$legacy","ref","loadingStatus","class"]);var a=M(),i=$(a);{let v=j(()=>E("relative flex size-8 shrink-0 overflow-hidden rounded-full",t.class));ut(i,()=>Te,(y,g)=>{g(y,K({"data-slot":"avatar",get class(){return e(v)}},()=>s,{get ref(){return o()},set ref(k){o(k)},get loadingStatus(){return d()},set loadingStatus(k){d(k)}}))})}c(h,a),R()}function je(h,t){D(t,!0);let o=S(t,"ref",15,null),d=J(t,["$$slots","$$events","$$legacy","ref","class"]);var s=M(),a=$(s);{let i=j(()=>E("aspect-square size-full",t.class));ut(a,()=>Ae,(v,y)=>{y(v,K({"data-slot":"avatar-image",get class(){return e(i)}},()=>d,{get ref(){return o()},set ref(g){o(g)}}))})}c(h,s),R()}function Le(h,t){D(t,!0);let o=S(t,"ref",15,null),d=J(t,["$$slots","$$events","$$legacy","ref","class"]);var s=M(),a=$(s);{let i=j(()=>E("bg-muted flex size-full items-center justify-center rounded-full",t.class));ut(a,()=>Me,(v,y)=>{y(v,K({"data-slot":"avatar-fallback",get class(){return e(i)}},()=>d,{get ref(){return o()},set ref(g){o(g)}}))})}c(h,s),R()}function ze(h,t){const o=kt(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.539.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const d=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}]];Pt(h,K({name:"house"},()=>o,{get iconNode(){return d},children:(s,a)=>{var i=M(),v=$(i);st(v,t,"default",{},null),c(s,i)},$$slots:{default:!0}}))}function Ee(h,t){const o=kt(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.539.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const d=[["path",{d:"m16 17 5-5-5-5"}],["path",{d:"M21 12H9"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}]];Pt(h,K({name:"log-out"},()=>o,{get iconNode(){return d},children:(s,a)=>{var i=M(),v=$(i);st(v,t,"default",{},null),c(s,i)},$$slots:{default:!0}}))}function Ne(h,t){const o=kt(t,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.539.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const d=[["path",{d:"M4 12h16"}],["path",{d:"M4 18h16"}],["path",{d:"M4 6h16"}]];Pt(h,K({name:"menu"},()=>o,{get iconNode(){return d},children:(s,a)=>{var i=M(),v=$(i);st(v,t,"default",{},null),c(s,i)},$$slots:{default:!0}}))}var We=L("<!> <!>",1),Ue=L("<a><!> </a>"),De=L("<!> Sign Out",1),Re=L('<div class="flex h-screen"><div><div class="glass-card h-full p-4 border-r border-white/10 rounded-none rounded-r-2xl"><div class="flex items-center mb-8"><div class="text-2xl font-bold text-white">✨ Client Portal</div></div> <div class="glass p-4 rounded-lg mb-6"><div class="flex items-center space-x-3"><!> <div class="flex-1 min-w-0"><p class="text-sm font-medium text-white truncate"> </p> <p class="text-xs text-slate-300 truncate"> </p></div></div> <div class="mt-3 flex items-center justify-between"><!> <!></div></div> <nav class="space-y-2"></nav> <div class="mt-auto pt-6"><!></div></div></div> <div><header class="glass-card border-b border-white/10 px-6 py-4"><div class="flex items-center justify-between"><button class="inline-flex items-center justify-center rounded-md px-3 py-2 text-sm font-medium text-white hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/20"><!></button> <div class="text-white"><h1 class="text-xl font-semibold"> </h1></div> <div class="flex items-center space-x-4"><!></div></div></header> <main class="p-6"><!></main></div></div>'),Be=L('<main class="min-h-screen flex items-center justify-center p-4"><!></main>'),He=L('<div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm"><div class="glass-card max-w-md w-full p-6 border-yellow-500/50"><div class="flex items-center mb-4"><!> <div><h3 class="text-lg font-semibold text-white">Session Timeout Warning</h3> <p class="text-sm text-slate-300">You will be automatically logged out in 30 seconds due to inactivity.</p></div></div> <div class="flex items-center justify-between pt-4"><div class="flex items-center text-sm text-slate-400"><!> Auto-logout in 30s</div> <div class="flex gap-2"><!> <!></div></div></div></div>'),qe=L('<div class="min-h-screen bg-gradient-to-br from-black via-slate-900 to-black"><div class="absolute inset-0 opacity-30"><div class="absolute inset-0 bg-gradient-to-br from-purple-900/20 via-slate-800/20 to-purple-800/20"></div> <div class="absolute inset-0" style="background-image: radial-gradient(circle at 25% 25%, rgba(30, 58, 138, 0.1) 0%, transparent 50%), radial-gradient(circle at 75% 75%, rgba(15, 23, 42, 0.1) 0%, transparent 50%);"></div></div> <!></div> <!>',1);function ia(h,t){D(t,!1);const[o,d]=ue(),s=()=>ve(me,"$page",o),a=G(),i=G(),v=G();let y=S(t,"data",8),g=G(!1),k=G(!1),C=null,m=null,p=G(!1);const l=300*1e3,x=4.5*60*1e3,N=[{name:"Dashboard",href:"/client-portal",icon:ze},{name:"Instagram Accounts",href:"/client-portal/accounts",icon:we},{name:"Analytics",href:"/client-portal/analytics",icon:Se},{name:"Settings",href:"/client-portal/settings",icon:ye}];le(()=>{A(k,!0),e(a)&&s().url.pathname.startsWith("/client-portal")&&Et()});function Et(){console.log("🔐 Setting up inactivity tracking with timeouts:",{WARNING_TIMEOUT:x,INACTIVITY_TIMEOUT:l});const u=()=>{C&&clearTimeout(C),m&&clearTimeout(m),A(p,!1),console.log("🔐 Resetting inactivity timers"),m=setTimeout(()=>{A(p,!0),console.log("🔐 Inactivity warning: Auto-logout in 3 seconds")},x),C=setTimeout(()=>{console.log("🔐 Auto-logout due to inactivity - calling handleLogout()"),rt()},l)};window.inactivityDebug={showWarning:()=>A(p,!0),triggerLogout:()=>rt(),resetTimer:u,getTimerState:()=>({hasWarningTimer:!!m,hasLogoutTimer:!!C,showingWarning:e(p)})};const b=["mousedown","mousemove","keypress","scroll","touchstart","click"];return b.forEach(T=>{document.addEventListener(T,u,!0)}),u(),()=>{b.forEach(T=>{document.removeEventListener(T,u,!0)}),C&&clearTimeout(C),m&&clearTimeout(m)}}function Gt(){A(p,!1),e(a)&&s().url.pathname.startsWith("/client-portal")&&Et()}function Ft(){A(g,!e(g))}async function rt(){try{console.log("🔐 Starting logout process...");try{const u=await fetch("/api/logout",{method:"POST",headers:{"Content-Type":"application/json"}});if(u.ok){const b=await u.json();console.log("🔐 Custom logout successful:",b)}}catch(u){console.log("🔐 Custom logout API call failed:",u)}try{if(typeof Vt<"u"){console.log("🔐 Using Auth.js signOut"),await Vt({callbackUrl:"/login",redirect:!0});return}}catch(u){console.log("🔐 Auth.js signOut failed:",u)}console.log("🔐 Using fallback logout method"),typeof localStorage<"u"&&localStorage.clear(),typeof sessionStorage<"u"&&sessionStorage.clear(),document.cookie.split(";").forEach(function(u){document.cookie=u.replace(/^ +/,"").replace(/=.*/,"=;expires="+new Date().toUTCString()+";path=/")}),console.log("🔐 Redirecting to login..."),window.location.href="/login"}catch(u){console.error("Logout error:",u),window.location.href="/login"}}xt(()=>dt(y()),()=>{A(a,y().user)}),xt(()=>s(),()=>{A(i,s().url.pathname)}),xt(()=>e(i),()=>{A(v,e(i).startsWith("/client-portal"))}),ce(),ie();var Nt=qe(),vt=$(Nt),Jt=_(n(vt),2);{var Kt=u=>{var b=Re(),T=n(b),B=n(T),Q=_(n(B),2),H=n(Q),q=n(H);Oe(q,{class:"h-10 w-10",children:(w,P)=>{var f=We(),W=$(f);je(W,{get src(){return e(a),I(()=>e(a).avatar)},get alt(){return e(a),I(()=>e(a).name)}});var pt=_(W,2);Le(pt,{class:"bg-purple-500/20 text-white",children:(Z,Ht)=>{z();var qt=F();tt(_t=>U(qt,_t),[()=>(e(a),I(()=>e(a).name.split(" ").map(_t=>_t[0]).join("")))]),c(Z,qt)},$$slots:{default:!0}}),c(w,f)},$$slots:{default:!0}});var ot=_(q,2),V=n(ot),it=n(V,!0);r(V);var nt=_(V,2),X=n(nt,!0);r(nt),r(ot),r(H);var lt=_(H,2),Y=n(lt);bt(Y,{variant:"secondary",class:"bg-blue-500/20 text-blue-200 hover:bg-blue-500/30",children:(w,P)=>{z();var f=F();tt(()=>U(f,(e(a),I(()=>e(a).subscription)))),c(w,f)},$$slots:{default:!0}});var te=_(Y,2);bt(te,{variant:"outline",class:"border-slate-500 text-slate-300",children:(w,P)=>{z();var f=F();tt(()=>U(f,(e(a),I(()=>e(a).role)))),c(w,f)},$$slots:{default:!0}}),r(lt),r(Q);var ft=_(Q,2);fe(ft,5,()=>N,ge,(w,P)=>{var f=Ue(),W=n(f);ut(W,()=>e(P).icon,(Z,Ht)=>{Ht(Z,{class:"h-5 w-5 mr-3"})});var pt=_(W);r(f),tt(Z=>{he(f,"href",(e(P),I(()=>e(P).href))),wt(f,1,Z),U(pt,` ${e(P),I(()=>e(P).name)??""}`)},[()=>yt((dt(E),e(i),e(P),I(()=>E("flex items-center text-sm font-medium rounded-lg transition-all duration-200 px-3 py-2",e(i)===e(P).href?"bg-blue-500/20 text-white shadow-lg":"text-slate-300 hover:bg-white/5 hover:text-white"))))]),c(w,f)}),r(ft);var Wt=_(ft,2),ee=n(Wt);St(ee,{variant:"ghost",class:"w-full text-slate-300 hover:text-white hover:bg-red-500/10 bg-transparent",onclick:rt,children:(w,P)=>{var f=De(),W=$(f);Ee(W,{class:"h-4 w-4 mr-2"}),z(),c(w,f)},$$slots:{default:!0}}),r(Wt),r(B),r(T);var gt=_(T,2),ht=n(gt),Ut=n(ht),ct=n(Ut),ae=n(ct);Ne(ae,{class:"h-5 w-5"}),r(ct);var mt=_(ct,2),Dt=n(mt),se=n(Dt,!0);r(Dt),r(mt);var Rt=_(mt,2),re=n(Rt);bt(re,{variant:"outline",class:"border-green-500 text-green-400",children:(w,P)=>{z();var f=F("● Online");c(w,f)},$$slots:{default:!0}}),r(Rt),r(Ut),r(ht);var Bt=_(ht,2),oe=n(Bt);st(oe,t,"default",{},null),r(Bt),r(gt),r(b),tt((w,P,f)=>{wt(T,1,w),U(it,(e(a),I(()=>e(a).name))),U(X,(e(a),I(()=>e(a).company))),wt(gt,1,P),U(se,f)},[()=>yt((dt(E),e(g),I(()=>E("fixed inset-y-0 z-50 flex flex-col transition-all duration-300 w-64",e(g)?"left-0":"-left-64")))),()=>yt((dt(E),e(g),I(()=>E("flex-1 transition-all duration-300",e(g)?"ml-64":"ml-0")))),()=>(e(i),I(()=>N.find(w=>w.href===e(i))?.name||"Dashboard"))]),de("click",ct,Ft),c(u,b)},Qt=u=>{var b=Be(),T=n(b);st(T,t,"default",{},null),r(b),c(u,b)};at(Jt,u=>{e(v)&&e(k)?u(Kt):u(Qt,!1)})}r(vt);var Xt=_(vt,2);{var Zt=u=>{var b=He(),T=n(b),B=n(T),Q=n(B);ke(Q,{class:"h-8 w-8 text-yellow-400 mr-3"}),z(2),r(B);var H=_(B,2),q=n(H),ot=n(q);$e(ot,{class:"h-4 w-4 mr-1"}),z(),r(q);var V=_(q,2),it=n(V);St(it,{variant:"ghost",size:"sm",class:"text-slate-300 hover:text-white",$$events:{click:rt},children:(X,lt)=>{z();var Y=F("Logout Now");c(X,Y)},$$slots:{default:!0}});var nt=_(it,2);St(nt,{size:"sm",class:"bg-blue-600 hover:bg-blue-700",$$events:{click:Gt},children:(X,lt)=>{z();var Y=F("Stay Logged In");c(X,Y)},$$slots:{default:!0}}),r(V),r(H),r(T),r(b),c(u,b)};at(Xt,u=>{e(p)&&u(Zt)})}c(h,Nt),R(),d()}export{ia as component};
