{"version":3,"file":"middleware-CRj8HrLf.js","sources":["../../../.svelte-kit/adapter-node/chunks/middleware.js"],"sourcesContent":["import { json } from \"@sveltejs/kit\";\nimport { z } from \"zod\";\nimport { D as DatabaseSecurityLogger } from \"./db-security-logger.js\";\nfunction getClientIP(request) {\n  const headers = request.headers;\n  return headers.get(\"cf-connecting-ip\") || // Cloudflare\n  headers.get(\"x-forwarded-for\")?.split(\",\")[0] || // Load balancer/proxy\n  headers.get(\"x-real-ip\") || // Nginx\n  headers.get(\"x-client-ip\") || // Apache\n  \"unknown\";\n}\nfunction getUserAgent(request) {\n  return request.headers.get(\"user-agent\") || \"unknown\";\n}\nfunction formatValidationErrors(error) {\n  return (error.errors || []).map((err) => ({\n    field: (err.path || []).join(\".\"),\n    message: err.message || \"Validation error\"\n  }));\n}\nasync function validateRequestBody(request, schema, options = {}) {\n  try {\n    const body = await request.json();\n    const validatedData = schema.parse(body);\n    if (options.logValidation) {\n      DatabaseSecurityLogger.logQuery(\n        `API_VALIDATION_SUCCESS: ${schema.constructor.name}`,\n        [JSON.stringify(body)],\n        0,\n        {\n          userId: options.userId,\n          ip: getClientIP(request),\n          userAgent: getUserAgent(request)\n        }\n      );\n    }\n    return { success: true, data: validatedData };\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      const validationError = {\n        success: false,\n        error: \"Validation failed\",\n        details: formatValidationErrors(error),\n        code: \"VALIDATION_ERROR\"\n      };\n      DatabaseSecurityLogger.logQuery(\n        `API_VALIDATION_FAILED: ${schema.constructor.name}`,\n        [JSON.stringify(error.errors)],\n        0,\n        {\n          userId: options.userId,\n          ip: getClientIP(request),\n          userAgent: getUserAgent(request),\n          error: \"Validation failed\"\n        }\n      );\n      return {\n        success: false,\n        response: json(validationError, { status: 400 })\n      };\n    }\n    const parseError = {\n      success: false,\n      error: \"Invalid JSON in request body\",\n      code: \"VALIDATION_ERROR\"\n    };\n    DatabaseSecurityLogger.logQuery(\n      \"API_JSON_PARSE_ERROR\",\n      [],\n      0,\n      {\n        userId: options.userId,\n        ip: getClientIP(request),\n        userAgent: getUserAgent(request),\n        error: \"JSON parse failed\"\n      }\n    );\n    return {\n      success: false,\n      response: json(parseError, { status: 400 })\n    };\n  }\n}\nfunction validateSearchParams(url, schema) {\n  try {\n    const params = {};\n    for (const [key, value] of url.searchParams.entries()) {\n      params[key] = value;\n    }\n    const validatedData = schema.parse(params);\n    return { success: true, data: validatedData };\n  } catch (error) {\n    if (error instanceof z.ZodError) {\n      const validationError = {\n        success: false,\n        error: \"Invalid query parameters\",\n        details: formatValidationErrors(error),\n        code: \"VALIDATION_ERROR\"\n      };\n      return {\n        success: false,\n        response: json(validationError, { status: 400 })\n      };\n    }\n    return {\n      success: false,\n      response: json(\n        {\n          success: false,\n          error: \"Parameter validation failed\",\n          code: \"VALIDATION_ERROR\"\n        },\n        { status: 400 }\n      )\n    };\n  }\n}\nasync function validateRateLimit(request, endpoint, limits) {\n  const clientIP = getClientIP(request);\n  const now = Date.now();\n  now - limits.windowMs;\n  DatabaseSecurityLogger.logQuery(\n    `RATE_LIMIT_CHECK: ${endpoint}`,\n    [clientIP, limits.requests.toString(), limits.windowMs.toString()],\n    0,\n    {\n      ip: clientIP,\n      userAgent: getUserAgent(request)\n    }\n  );\n  return { allowed: true };\n}\nasync function validateAPIRequest(event, options = {}) {\n  const { request, url, locals } = event;\n  try {\n    if (options.requireAuth && !locals.user) {\n      return {\n        success: false,\n        response: json(\n          {\n            success: false,\n            error: \"Authentication required\",\n            code: \"AUTH_REQUIRED\"\n          },\n          { status: 401 }\n        )\n      };\n    }\n    if (options.rateLimit) {\n      const rateLimitResult = await validateRateLimit(\n        request,\n        url.pathname,\n        options.rateLimit\n      );\n      if (!rateLimitResult.allowed) {\n        return { success: false, response: rateLimitResult.response };\n      }\n    }\n    let bodyData;\n    if (options.bodySchema) {\n      const bodyValidation = await validateRequestBody(request, options.bodySchema, {\n        logValidation: options.logRequest,\n        userId: locals.user?.id\n      });\n      if (!bodyValidation.success) {\n        return { success: false, response: bodyValidation.response };\n      }\n      bodyData = bodyValidation.data;\n    }\n    let paramsData;\n    if (options.paramsSchema) {\n      const paramsValidation = validateSearchParams(url, options.paramsSchema);\n      if (!paramsValidation.success) {\n        return { success: false, response: paramsValidation.response };\n      }\n      paramsData = paramsValidation.data;\n    }\n    return {\n      success: true,\n      body: bodyData,\n      params: paramsData,\n      userId: locals.user?.id\n    };\n  } catch (error) {\n    DatabaseSecurityLogger.logQuery(\n      \"API_VALIDATION_UNEXPECTED_ERROR\",\n      [],\n      0,\n      {\n        userId: locals.user?.id,\n        ip: getClientIP(request),\n        userAgent: getUserAgent(request),\n        error: error instanceof Error ? error.message : \"Unknown error\"\n      }\n    );\n    return {\n      success: false,\n      response: json(\n        {\n          success: false,\n          error: \"Request validation failed\",\n          code: \"VALIDATION_ERROR\"\n        },\n        { status: 500 }\n      )\n    };\n  }\n}\nasync function validateAPIRequestComprehensive(event, options = {}) {\n  const {\n    requireAuth = false,\n    allowedRoles = [],\n    rateLimit,\n    bodySchema,\n    querySchema,\n    logAttempts = false\n  } = options;\n  if (rateLimit) {\n    const { createRateLimit } = await import(\"./rate-limiter.js\");\n    const rateLimiter = createRateLimit({\n      windowMs: rateLimit.windowMs,\n      requests: rateLimit.requests,\n      keyGenerator: rateLimit.keyGenerator\n    });\n    const limitResponse = await rateLimiter(event);\n    if (limitResponse) {\n      return { success: false, response: limitResponse };\n    }\n  }\n  if (requireAuth) {\n    const user = event.locals.user;\n    if (!user) {\n      if (logAttempts) {\n        DatabaseSecurityLogger.logQuery(\n          \"UNAUTHORIZED_API_ACCESS_ATTEMPT\",\n          [],\n          0,\n          {\n            ip: event.getClientAddress(),\n            userAgent: event.request.headers.get(\"user-agent\"),\n            error: \"Authentication required\"\n          }\n        );\n      }\n      return {\n        success: false,\n        response: json(\n          {\n            error: \"Authentication required\",\n            code: \"AUTH_REQUIRED\"\n          },\n          { status: 401 }\n        )\n      };\n    }\n    if (allowedRoles.length > 0 && !allowedRoles.includes(user.role)) {\n      if (logAttempts) {\n        DatabaseSecurityLogger.logQuery(\n          \"INSUFFICIENT_PERMISSIONS\",\n          [],\n          0,\n          {\n            userId: user.id,\n            ip: event.getClientAddress(),\n            userAgent: event.request.headers.get(\"user-agent\"),\n            error: `Role ${user.role} not in allowed roles: ${allowedRoles.join(\", \")}`\n          }\n        );\n      }\n      return {\n        success: false,\n        response: json(\n          {\n            error: \"Insufficient permissions\",\n            code: \"INSUFFICIENT_PERMISSIONS\"\n          },\n          { status: 403 }\n        )\n      };\n    }\n  }\n  let validatedBody;\n  let validatedQuery;\n  if (bodySchema && (event.request.method === \"POST\" || event.request.method === \"PUT\" || event.request.method === \"PATCH\")) {\n    const bodyResult = await validateRequestBody(event.request, bodySchema, {\n      logValidation: logAttempts,\n      userId: event.locals.user?.id\n    });\n    if (!bodyResult.success) {\n      return { success: false, response: bodyResult.response };\n    }\n    validatedBody = bodyResult.data;\n  }\n  if (querySchema) {\n    const queryResult = validateSearchParams(event.url, querySchema);\n    if (!queryResult.success) {\n      return { success: false, response: queryResult.response };\n    }\n    validatedQuery = queryResult.data;\n  }\n  return {\n    success: true,\n    user: event.locals.user,\n    body: validatedBody,\n    query: validatedQuery\n  };\n}\nexport {\n  validateAPIRequestComprehensive as a,\n  validateAPIRequest as v\n};\n"],"names":[],"mappings":";;;;AAGA,SAAS,WAAW,CAAC,OAAO,EAAE;AAC9B,EAAE,MAAM,OAAO,GAAG,OAAO,CAAC,OAAO;AACjC,EAAE,OAAO,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC;AACxC,EAAE,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;AAC/C,EAAE,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC;AAC1B,EAAE,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC;AAC5B,EAAE,SAAS;AACX;AACA,SAAS,YAAY,CAAC,OAAO,EAAE;AAC/B,EAAE,OAAO,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,SAAS;AACvD;AACA,SAAS,sBAAsB,CAAC,KAAK,EAAE;AACvC,EAAE,OAAO,CAAC,KAAK,CAAC,MAAM,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC,GAAG,MAAM;AAC5C,IAAI,KAAK,EAAE,CAAC,GAAG,CAAC,IAAI,IAAI,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC;AACrC,IAAI,OAAO,EAAE,GAAG,CAAC,OAAO,IAAI;AAC5B,GAAG,CAAC,CAAC;AACL;AACA,eAAe,mBAAmB,CAAC,OAAO,EAAE,MAAM,EAAE,OAAO,GAAG,EAAE,EAAE;AAClE,EAAE,IAAI;AACN,IAAI,MAAM,IAAI,GAAG,MAAM,OAAO,CAAC,IAAI,EAAE;AACrC,IAAI,MAAM,aAAa,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC;AAC5C,IAAI,IAAI,OAAO,CAAC,aAAa,EAAE;AAC/B,MAAM,sBAAsB,CAAC,QAAQ;AACrC,QAAQ,CAAC,wBAAwB,EAAE,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;AAC5D,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;AAC9B,QAAQ,CAAC;AACT,QAAQ;AACR,UAAU,MAAM,EAAE,OAAO,CAAC,MAAM;AAChC,UAAU,EAAE,EAAE,WAAW,CAAC,OAAO,CAAC;AAClC,UAAU,SAAS,EAAE,YAAY,CAAC,OAAO;AACzC;AACA,OAAO;AACP,IAAI;AACJ,IAAI,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,aAAa,EAAE;AACjD,EAAE,CAAC,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,IAAI,KAAK,YAAY,CAAC,CAAC,QAAQ,EAAE;AACrC,MAAM,MAAM,eAAe,GAAG;AAC9B,QAAQ,OAAO,EAAE,KAAK;AACtB,QAAQ,KAAK,EAAE,mBAAmB;AAClC,QAAQ,OAAO,EAAE,sBAAsB,CAAC,KAAK,CAAC;AAC9C,QAAQ,IAAI,EAAE;AACd,OAAO;AACP,MAAM,sBAAsB,CAAC,QAAQ;AACrC,QAAQ,CAAC,uBAAuB,EAAE,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;AAC3D,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;AACtC,QAAQ,CAAC;AACT,QAAQ;AACR,UAAU,MAAM,EAAE,OAAO,CAAC,MAAM;AAChC,UAAU,EAAE,EAAE,WAAW,CAAC,OAAO,CAAC;AAClC,UAAU,SAAS,EAAE,YAAY,CAAC,OAAO,CAAC;AAC1C,UAAU,KAAK,EAAE;AACjB;AACA,OAAO;AACP,MAAM,OAAO;AACb,QAAQ,OAAO,EAAE,KAAK;AACtB,QAAQ,QAAQ,EAAE,IAAI,CAAC,eAAe,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE;AACvD,OAAO;AACP,IAAI;AACJ,IAAI,MAAM,UAAU,GAAG;AACvB,MAAM,OAAO,EAAE,KAAK;AACpB,MAAM,KAAK,EAAE,8BAA8B;AAC3C,MAAM,IAAI,EAAE;AACZ,KAAK;AACL,IAAI,sBAAsB,CAAC,QAAQ;AACnC,MAAM,sBAAsB;AAC5B,MAAM,EAAE;AACR,MAAM,CAAC;AACP,MAAM;AACN,QAAQ,MAAM,EAAE,OAAO,CAAC,MAAM;AAC9B,QAAQ,EAAE,EAAE,WAAW,CAAC,OAAO,CAAC;AAChC,QAAQ,SAAS,EAAE,YAAY,CAAC,OAAO,CAAC;AACxC,QAAQ,KAAK,EAAE;AACf;AACA,KAAK;AACL,IAAI,OAAO;AACX,MAAM,OAAO,EAAE,KAAK;AACpB,MAAM,QAAQ,EAAE,IAAI,CAAC,UAAU,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE;AAChD,KAAK;AACL,EAAE;AACF;AACA,SAAS,oBAAoB,CAAC,GAAG,EAAE,MAAM,EAAE;AAC3C,EAAE,IAAI;AACN,IAAI,MAAM,MAAM,GAAG,EAAE;AACrB,IAAI,KAAK,MAAM,CAAC,GAAG,EAAE,KAAK,CAAC,IAAI,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,EAAE;AAC3D,MAAM,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK;AACzB,IAAI;AACJ,IAAI,MAAM,aAAa,GAAG,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC;AAC9C,IAAI,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,aAAa,EAAE;AACjD,EAAE,CAAC,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,IAAI,KAAK,YAAY,CAAC,CAAC,QAAQ,EAAE;AACrC,MAAM,MAAM,eAAe,GAAG;AAC9B,QAAQ,OAAO,EAAE,KAAK;AACtB,QAAQ,KAAK,EAAE,0BAA0B;AACzC,QAAQ,OAAO,EAAE,sBAAsB,CAAC,KAAK,CAAC;AAC9C,QAAQ,IAAI,EAAE;AACd,OAAO;AACP,MAAM,OAAO;AACb,QAAQ,OAAO,EAAE,KAAK;AACtB,QAAQ,QAAQ,EAAE,IAAI,CAAC,eAAe,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE;AACvD,OAAO;AACP,IAAI;AACJ,IAAI,OAAO;AACX,MAAM,OAAO,EAAE,KAAK;AACpB,MAAM,QAAQ,EAAE,IAAI;AACpB,QAAQ;AACR,UAAU,OAAO,EAAE,KAAK;AACxB,UAAU,KAAK,EAAE,6BAA6B;AAC9C,UAAU,IAAI,EAAE;AAChB,SAAS;AACT,QAAQ,EAAE,MAAM,EAAE,GAAG;AACrB;AACA,KAAK;AACL,EAAE;AACF;AACA,eAAe,iBAAiB,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE;AAC5D,EAAE,MAAM,QAAQ,GAAG,WAAW,CAAC,OAAO,CAAC;AACvC,EAAE,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE;AACxB,EAAE,GAAG,GAAG,MAAM,CAAC,QAAQ;AACvB,EAAE,sBAAsB,CAAC,QAAQ;AACjC,IAAI,CAAC,kBAAkB,EAAE,QAAQ,CAAC,CAAC;AACnC,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,EAAE,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;AACtE,IAAI,CAAC;AACL,IAAI;AACJ,MAAM,EAAE,EAAE,QAAQ;AAClB,MAAM,SAAS,EAAE,YAAY,CAAC,OAAO;AACrC;AACA,GAAG;AACH,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE;AAC1B;AACA,eAAe,kBAAkB,CAAC,KAAK,EAAE,OAAO,GAAG,EAAE,EAAE;AACvD,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,KAAK;AACxC,EAAE,IAAI;AACN,IAAI,IAAI,OAAO,CAAC,WAAW,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;AAC7C,MAAM,OAAO;AACb,QAAQ,OAAO,EAAE,KAAK;AACtB,QAAQ,QAAQ,EAAE,IAAI;AACtB,UAAU;AACV,YAAY,OAAO,EAAE,KAAK;AAC1B,YAAY,KAAK,EAAE,yBAAyB;AAC5C,YAAY,IAAI,EAAE;AAClB,WAAW;AACX,UAAU,EAAE,MAAM,EAAE,GAAG;AACvB;AACA,OAAO;AACP,IAAI;AACJ,IAAI,IAAI,OAAO,CAAC,SAAS,EAAE;AAC3B,MAAM,MAAM,eAAe,GAAG,MAAM,iBAAiB;AACrD,QAAQ,OAAO;AACf,QAAQ,GAAG,CAAC,QAAQ;AACpB,QAAQ,OAAO,CAAC;AAChB,OAAO;AACP,MAAM,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE;AACpC,QAAQ,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,eAAe,CAAC,QAAQ,EAAE;AACrE,MAAM;AACN,IAAI;AACJ,IAAI,IAAI,QAAQ;AAChB,IAAI,IAAI,OAAO,CAAC,UAAU,EAAE;AAC5B,MAAM,MAAM,cAAc,GAAG,MAAM,mBAAmB,CAAC,OAAO,EAAE,OAAO,CAAC,UAAU,EAAE;AACpF,QAAQ,aAAa,EAAE,OAAO,CAAC,UAAU;AACzC,QAAQ,MAAM,EAAE,MAAM,CAAC,IAAI,EAAE;AAC7B,OAAO,CAAC;AACR,MAAM,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE;AACnC,QAAQ,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,cAAc,CAAC,QAAQ,EAAE;AACpE,MAAM;AACN,MAAM,QAAQ,GAAG,cAAc,CAAC,IAAI;AACpC,IAAI;AACJ,IAAI,IAAI,UAAU;AAClB,IAAI,IAAI,OAAO,CAAC,YAAY,EAAE;AAC9B,MAAM,MAAM,gBAAgB,GAAG,oBAAoB,CAAC,GAAG,EAAE,OAAO,CAAC,YAAY,CAAC;AAC9E,MAAM,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE;AACrC,QAAQ,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,gBAAgB,CAAC,QAAQ,EAAE;AACtE,MAAM;AACN,MAAM,UAAU,GAAG,gBAAgB,CAAC,IAAI;AACxC,IAAI;AACJ,IAAI,OAAO;AACX,MAAM,OAAO,EAAE,IAAI;AACnB,MAAM,IAAI,EAAE,QAAQ;AACpB,MAAM,MAAM,EAAE,UAAU;AACxB,MAAM,MAAM,EAAE,MAAM,CAAC,IAAI,EAAE;AAC3B,KAAK;AACL,EAAE,CAAC,CAAC,OAAO,KAAK,EAAE;AAClB,IAAI,sBAAsB,CAAC,QAAQ;AACnC,MAAM,iCAAiC;AACvC,MAAM,EAAE;AACR,MAAM,CAAC;AACP,MAAM;AACN,QAAQ,MAAM,EAAE,MAAM,CAAC,IAAI,EAAE,EAAE;AAC/B,QAAQ,EAAE,EAAE,WAAW,CAAC,OAAO,CAAC;AAChC,QAAQ,SAAS,EAAE,YAAY,CAAC,OAAO,CAAC;AACxC,QAAQ,KAAK,EAAE,KAAK,YAAY,KAAK,GAAG,KAAK,CAAC,OAAO,GAAG;AACxD;AACA,KAAK;AACL,IAAI,OAAO;AACX,MAAM,OAAO,EAAE,KAAK;AACpB,MAAM,QAAQ,EAAE,IAAI;AACpB,QAAQ;AACR,UAAU,OAAO,EAAE,KAAK;AACxB,UAAU,KAAK,EAAE,2BAA2B;AAC5C,UAAU,IAAI,EAAE;AAChB,SAAS;AACT,QAAQ,EAAE,MAAM,EAAE,GAAG;AACrB;AACA,KAAK;AACL,EAAE;AACF;AACA,eAAe,+BAA+B,CAAC,KAAK,EAAE,OAAO,GAAG,EAAE,EAAE;AACpE,EAAE,MAAM;AACR,IAAI,WAAW,GAAG,KAAK;AACvB,IAAI,YAAY,GAAG,EAAE;AACrB,IAAI,SAAS;AACb,IAAI,UAAU;AACd,IAAI,WAAW;AACf,IAAI,WAAW,GAAG;AAClB,GAAG,GAAG,OAAO;AACb,EAAE,IAAI,SAAS,EAAE;AACjB,IAAI,MAAM,EAAE,eAAe,EAAE,GAAG,MAAM,OAAO,4BAAmB,CAAC;AACjE,IAAI,MAAM,WAAW,GAAG,eAAe,CAAC;AACxC,MAAM,QAAQ,EAAE,SAAS,CAAC,QAAQ;AAClC,MAAM,QAAQ,EAAE,SAAS,CAAC,QAAQ;AAClC,MAAM,YAAY,EAAE,SAAS,CAAC;AAC9B,KAAK,CAAC;AACN,IAAI,MAAM,aAAa,GAAG,MAAM,WAAW,CAAC,KAAK,CAAC;AAClD,IAAI,IAAI,aAAa,EAAE;AACvB,MAAM,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,aAAa,EAAE;AACxD,IAAI;AACJ,EAAE;AACF,EAAE,IAAI,WAAW,EAAE;AACnB,IAAI,MAAM,IAAI,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI;AAClC,IAAI,IAAI,CAAC,IAAI,EAAE;AACf,MAAM,IAAI,WAAW,EAAE;AACvB,QAAQ,sBAAsB,CAAC,QAAQ;AACvC,UAAU,iCAAiC;AAC3C,UAAU,EAAE;AACZ,UAAU,CAAC;AACX,UAAU;AACV,YAAY,EAAE,EAAE,KAAK,CAAC,gBAAgB,EAAE;AACxC,YAAY,SAAS,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC;AAC9D,YAAY,KAAK,EAAE;AACnB;AACA,SAAS;AACT,MAAM;AACN,MAAM,OAAO;AACb,QAAQ,OAAO,EAAE,KAAK;AACtB,QAAQ,QAAQ,EAAE,IAAI;AACtB,UAAU;AACV,YAAY,KAAK,EAAE,yBAAyB;AAC5C,YAAY,IAAI,EAAE;AAClB,WAAW;AACX,UAAU,EAAE,MAAM,EAAE,GAAG;AACvB;AACA,OAAO;AACP,IAAI;AACJ,IAAI,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;AACtE,MAAM,IAAI,WAAW,EAAE;AACvB,QAAQ,sBAAsB,CAAC,QAAQ;AACvC,UAAU,0BAA0B;AACpC,UAAU,EAAE;AACZ,UAAU,CAAC;AACX,UAAU;AACV,YAAY,MAAM,EAAE,IAAI,CAAC,EAAE;AAC3B,YAAY,EAAE,EAAE,KAAK,CAAC,gBAAgB,EAAE;AACxC,YAAY,SAAS,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC;AAC9D,YAAY,KAAK,EAAE,CAAC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACtF;AACA,SAAS;AACT,MAAM;AACN,MAAM,OAAO;AACb,QAAQ,OAAO,EAAE,KAAK;AACtB,QAAQ,QAAQ,EAAE,IAAI;AACtB,UAAU;AACV,YAAY,KAAK,EAAE,0BAA0B;AAC7C,YAAY,IAAI,EAAE;AAClB,WAAW;AACX,UAAU,EAAE,MAAM,EAAE,GAAG;AACvB;AACA,OAAO;AACP,IAAI;AACJ,EAAE;AACF,EAAE,IAAI,aAAa;AACnB,EAAE,IAAI,cAAc;AACpB,EAAE,IAAI,UAAU,KAAK,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,KAAK,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,EAAE;AAC7H,IAAI,MAAM,UAAU,GAAG,MAAM,mBAAmB,CAAC,KAAK,CAAC,OAAO,EAAE,UAAU,EAAE;AAC5E,MAAM,aAAa,EAAE,WAAW;AAChC,MAAM,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE;AACjC,KAAK,CAAC;AACN,IAAI,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE;AAC7B,MAAM,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,UAAU,CAAC,QAAQ,EAAE;AAC9D,IAAI;AACJ,IAAI,aAAa,GAAG,UAAU,CAAC,IAAI;AACnC,EAAE;AACF,EAAE,IAAI,WAAW,EAAE;AACnB,IAAI,MAAM,WAAW,GAAG,oBAAoB,CAAC,KAAK,CAAC,GAAG,EAAE,WAAW,CAAC;AACpE,IAAI,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE;AAC9B,MAAM,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,WAAW,CAAC,QAAQ,EAAE;AAC/D,IAAI;AACJ,IAAI,cAAc,GAAG,WAAW,CAAC,IAAI;AACrC,EAAE;AACF,EAAE,OAAO;AACT,IAAI,OAAO,EAAE,IAAI;AACjB,IAAI,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,IAAI;AAC3B,IAAI,IAAI,EAAE,aAAa;AACvB,IAAI,KAAK,EAAE;AACX,GAAG;AACH;;;;"}